<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Agenda</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="caixa">
        <h1>Agenda</h1>
        <input id="tarefa" type="text" placeholder="Insira aqui sua tarefa">
        <input id="seleciona-data" type="date"/>
        <button onclick="adicionarTarefa()">Adicionar Tarefas</button>
        <div id="lista-de-tarefas"></div>

        <script>
            let afazeres;
            const afazeresSalvos = JSON.parse(localStorage.getItem("afazeres"));
            if(Array.isArray(afazeresSalvos)){
                afazeres = afazeresSalvos;
            }else{
                afazeres = [
                    { nome: "Lavar louça", data: "15-08-2025", id: "id1" },
                    { nome: "Lavar o banheiro", data: "20-08-2025", id: "id2" },
                    { nome: "Estender a roupa", data: "25-08-2025", id: "id3" },
                    { nome: "Assistir o jogo do São Paulo'", data: "16-08-2025", id: "id4" }
                ];
            }

            const salvarTarefas = () => localStorage.setItem("afazeres", JSON.stringify(afazeres));
            salvarTarefas();
            
            const renderizar = () =>{
                document.getElementById("lista-de-tarefas").innerHTML = "";
                afazeres.forEach((tarefa) => {
                    const elemento = document.createElement("div");
                    elemento.innerHTML = tarefa.nome + " " + tarefa.data;

                    const botaoApagar = document.createElement("img");
                    botaoApagar.src = "lixeira].png";
                    botaoApagar.alt = "Excluir";    
                    botaoApagar.className = "btn-excluir";
                    botaoApagar.id = tarefa.id;
                    botaoApagar.onclick = apagarTarefa;
                    elemento.appendChild(botaoApagar);

                    const listaDeTarefas = document.getElementById("lista-de-tarefas");
                    listaDeTarefas.appendChild(elemento);
                }); 
            }

            const adicionarTarefa = () => {
                const campoTarefa = document.getElementById("tarefa");
                const tarefa = campoTarefa.value;
                const campoData = document.getElementById("seleciona-data");
                const prazo = campoData.value;

                // --- Validação adicionada aqui ---
                if (tarefa.trim() === "") {
                    alert("Por favor, insira um nome para a tarefa!");
                    return; // Interrompe a função se o campo estiver vazio
                }
                // --- Fim da validação ---

                const cron = "" + new Date().getTime();

                afazeres.push({ nome: tarefa, data: prazo, id: cron });
                salvarTarefas();
                renderizar();
            }
            
            const apagarTarefa = (evento) => {
                const botaoApagar = evento.target;
                const idASerApagado = botaoApagar.id;
                afazeres = afazeres.filter((tarefa)=> tarefa.id !== idASerApagado);
                salvarTarefas();
                renderizar();
            };

            renderizar();
        </script>
</body>
</html>